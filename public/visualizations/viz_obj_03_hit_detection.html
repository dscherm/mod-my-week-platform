<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hit Detection - contains() Method</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      min-height: 100vh;
      color: #fff;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #00d9ff;
      margin-bottom: 10px;
    }
    .subtitle {
      text-align: center;
      color: #b0b0c0;
      margin-bottom: 20px;
    }
    .main-content {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }
    .canvas-container {
      flex: 1;
      min-width: 550px;
      background: #0d1117;
      border-radius: 12px;
      padding: 15px;
      border: 1px solid #30363d;
    }
    .side-panel {
      width: 350px;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    .panel {
      background: #0d1117;
      border-radius: 12px;
      padding: 15px;
      border: 1px solid #30363d;
    }
    .panel h3 {
      color: #4ade80;
      margin-bottom: 10px;
      font-size: 1rem;
    }
    .code-block {
      background: #161b22;
      border-radius: 8px;
      padding: 12px;
      font-family: 'Consolas', monospace;
      font-size: 11px;
      color: #4ade80;
      border-left: 3px solid #4ade80;
      white-space: pre;
    }
    .math-display {
      background: #161b22;
      border-radius: 8px;
      padding: 15px;
      text-align: center;
      font-family: 'Consolas', monospace;
    }
    .math-formula {
      font-size: 1.1rem;
      color: #ffd93d;
      margin: 10px 0;
    }
    .math-result {
      font-size: 1.3rem;
      padding: 10px;
      border-radius: 8px;
      margin-top: 10px;
    }
    .math-result.inside {
      background: rgba(74, 222, 128, 0.2);
      color: #4ade80;
      border: 2px solid #4ade80;
    }
    .math-result.outside {
      background: rgba(233, 69, 96, 0.2);
      color: #e94560;
      border: 2px solid #e94560;
    }
    .values-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
      margin-top: 10px;
    }
    .value-box {
      background: #161b22;
      padding: 8px;
      border-radius: 6px;
      text-align: center;
    }
    .value-label {
      font-size: 0.7rem;
      color: #6b7280;
    }
    .value-num {
      font-size: 1.1rem;
      font-family: monospace;
      color: #00d9ff;
    }
    .key-insight {
      background: linear-gradient(135deg, rgba(255,217,61,0.1), rgba(255,217,61,0.05));
      border: 1px solid #ffd93d;
      border-radius: 8px;
      padding: 12px;
    }
    .key-insight h4 {
      color: #ffd93d;
      margin-bottom: 5px;
    }
    .key-insight p {
      color: #b0b0c0;
      font-size: 0.85rem;
    }
    .click-counter {
      text-align: center;
      font-size: 2rem;
      font-weight: bold;
      color: #4ade80;
      margin: 10px 0;
    }
    .instruction {
      text-align: center;
      color: #6b7280;
      font-size: 0.85rem;
      padding: 10px;
      background: #161b22;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üéØ Hit Detection: The contains() Method</h1>
    <p class="subtitle">Move your mouse to see the distance calculation in real-time</p>
    
    <div class="main-content">
      <div class="canvas-container">
        <div id="canvas-holder"></div>
        <div class="instruction">Move mouse over circles ‚Ä¢ Click to score points!</div>
      </div>
      
      <div class="side-panel">
        <div class="panel">
          <h3>üìê The Math</h3>
          <div class="math-display">
            <div style="color: #b0b0c0; font-size: 0.8rem;">Distance Formula:</div>
            <div class="math-formula">d = ‚àö[(x‚ÇÇ-x‚ÇÅ)¬≤ + (y‚ÇÇ-y‚ÇÅ)¬≤]</div>
            <div style="color: #b0b0c0; font-size: 0.8rem; margin-top: 15px;">Current Calculation:</div>
            <div class="values-grid">
              <div class="value-box">
                <div class="value-label">Mouse X</div>
                <div class="value-num" id="mouse-x">0</div>
              </div>
              <div class="value-box">
                <div class="value-label">Mouse Y</div>
                <div class="value-num" id="mouse-y">0</div>
              </div>
              <div class="value-box">
                <div class="value-label">Distance</div>
                <div class="value-num" id="distance">0</div>
              </div>
              <div class="value-box">
                <div class="value-label">Target Radius</div>
                <div class="value-num" id="radius">0</div>
              </div>
            </div>
            <div class="math-result outside" id="result">
              dist > radius ‚Üí OUTSIDE
            </div>
          </div>
        </div>
        
        <div class="panel">
          <h3>üíª The contains() Method</h3>
          <div class="code-block">contains(px, py) {
  let d = dist(px, py, this.x, this.y);
  return d < this.radius;
}

// Usage in mousePressed:
if (target.contains(mouseX, mouseY)) {
  score++;
}</div>
        </div>
        
        <div class="panel">
          <h3>üèÜ Score</h3>
          <div class="click-counter" id="score">0</div>
          <p style="text-align: center; color: #6b7280; font-size: 0.8rem;">Click targets to score!</p>
        </div>
        
        <div class="key-insight">
          <h4>üí° Key Insight</h4>
          <p>A point is INSIDE a circle when its distance from the center is LESS than the radius. The dist() function calculates this for us!</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    let targets = [];
    let score = 0;
    let closestTarget = null;
    let hitEffect = null;
    
    function setup() {
      let canvas = createCanvas(580, 420);
      canvas.parent('canvas-holder');
      
      // Create random targets
      for (let i = 0; i < 5; i++) {
        targets.push(new Target(
          random(80, width - 80),
          random(80, height - 80),
          random(35, 60)
        ));
      }
    }
    
    function draw() {
      background(20, 22, 30);
      
      // Grid
      stroke(35, 40, 50);
      strokeWeight(1);
      for (let x = 0; x < width; x += 40) line(x, 0, x, height);
      for (let y = 0; y < height; y += 40) line(0, y, width, y);
      
      // Find closest target for display
      closestTarget = null;
      let closestDist = Infinity;
      
      for (let t of targets) {
        let d = dist(mouseX, mouseY, t.x, t.y);
        if (d < closestDist) {
          closestDist = d;
          closestTarget = t;
        }
      }
      
      // Draw distance line to closest target
      if (closestTarget) {
        // Distance line
        stroke(100, 100, 120);
        strokeWeight(1);
        drawingContext.setLineDash([5, 5]);
        line(mouseX, mouseY, closestTarget.x, closestTarget.y);
        drawingContext.setLineDash([]);
        
        // Radius visualization
        if (closestDist < closestTarget.radius) {
          stroke(74, 222, 128, 100);
        } else {
          stroke(233, 69, 96, 100);
        }
        strokeWeight(2);
        noFill();
        ellipse(closestTarget.x, closestTarget.y, closestTarget.radius * 2);
        
        // Update UI
        updateMathDisplay(closestTarget, closestDist);
      }
      
      // Draw all targets
      for (let t of targets) {
        t.update();
        t.display();
      }
      
      // Draw hit effect
      if (hitEffect) {
        hitEffect.display();
        if (hitEffect.isDone()) hitEffect = null;
      }
      
      // Draw mouse cursor
      noStroke();
      fill(0, 217, 255);
      ellipse(mouseX, mouseY, 10);
      fill(255);
      ellipse(mouseX, mouseY, 4);
      
      // Crosshair
      stroke(0, 217, 255, 150);
      strokeWeight(1);
      line(mouseX - 15, mouseY, mouseX - 5, mouseY);
      line(mouseX + 5, mouseY, mouseX + 15, mouseY);
      line(mouseX, mouseY - 15, mouseX, mouseY - 5);
      line(mouseX, mouseY + 5, mouseX, mouseY + 15);
    }
    
    function updateMathDisplay(target, d) {
      document.getElementById('mouse-x').textContent = int(mouseX);
      document.getElementById('mouse-y').textContent = int(mouseY);
      document.getElementById('distance').textContent = d.toFixed(1);
      document.getElementById('radius').textContent = target.radius.toFixed(0);
      
      let resultEl = document.getElementById('result');
      if (d < target.radius) {
        resultEl.className = 'math-result inside';
        resultEl.innerHTML = `${d.toFixed(1)} < ${target.radius.toFixed(0)} ‚Üí <strong>INSIDE!</strong>`;
      } else {
        resultEl.className = 'math-result outside';
        resultEl.innerHTML = `${d.toFixed(1)} > ${target.radius.toFixed(0)} ‚Üí OUTSIDE`;
      }
    }
    
    function mousePressed() {
      for (let i = targets.length - 1; i >= 0; i--) {
        if (targets[i].contains(mouseX, mouseY)) {
          score++;
          document.getElementById('score').textContent = score;
          
          // Hit effect
          hitEffect = new HitEffect(targets[i].x, targets[i].y);
          
          // Replace with new target
          targets[i] = new Target(
            random(80, width - 80),
            random(80, height - 80),
            random(35, 60)
          );
          
          break; // Only hit one target
        }
      }
    }
    
    class Target {
      constructor(x, y, radius) {
        this.x = x;
        this.y = y;
        this.radius = radius;
        this.baseRadius = radius;
        this.hovered = false;
        this.pulse = random(TWO_PI);
        this.hue = random(360);
      }
      
      contains(px, py) {
        let d = dist(px, py, this.x, this.y);
        return d < this.radius;
      }
      
      update() {
        this.hovered = this.contains(mouseX, mouseY);
        this.pulse += 0.05;
        
        // Pulse effect when hovered
        if (this.hovered) {
          this.radius = this.baseRadius + sin(this.pulse * 3) * 5;
        } else {
          this.radius = this.baseRadius + sin(this.pulse) * 2;
        }
      }
      
      display() {
        push();
        colorMode(HSB);
        
        // Glow
        if (this.hovered) {
          for (let i = 3; i > 0; i--) {
            noStroke();
            fill(this.hue, 80, 100, 0.1);
            ellipse(this.x, this.y, this.radius * 2 + i * 15);
          }
        }
        
        // Outer ring
        stroke(this.hue, 70, 90);
        strokeWeight(3);
        noFill();
        ellipse(this.x, this.y, this.radius * 2);
        
        // Inner rings
        stroke(this.hue, 70, 90, 0.5);
        strokeWeight(2);
        ellipse(this.x, this.y, this.radius * 1.3);
        ellipse(this.x, this.y, this.radius * 0.6);
        
        // Center
        fill(this.hue, 80, 100);
        noStroke();
        ellipse(this.x, this.y, 10);
        
        // Radius label
        if (this.hovered) {
          fill(255);
          textSize(10);
          textAlign(CENTER);
          text(`r = ${this.baseRadius.toFixed(0)}`, this.x, this.y + this.radius + 15);
        }
        
        pop();
      }
    }
    
    class HitEffect {
      constructor(x, y) {
        this.x = x;
        this.y = y;
        this.size = 0;
        this.alpha = 255;
      }
      
      display() {
        noFill();
        stroke(74, 222, 128, this.alpha);
        strokeWeight(3);
        ellipse(this.x, this.y, this.size);
        
        fill(74, 222, 128, this.alpha);
        noStroke();
        textSize(20);
        textAlign(CENTER, CENTER);
        text("+1", this.x, this.y - this.size/2 - 10);
        
        this.size += 8;
        this.alpha -= 10;
      }
      
      isDone() {
        return this.alpha <= 0;
      }
    }
  </script>
</body>
</html>
